- sensor:
    - unique_id: power_total
      default_entity_id: sensor.power_total
      name: "Power Total"
      icon: mdi:power
      state: >
        {{ states('sensor.shelly_3em_channel_a_power')|float(0) +
          states('sensor.shelly_3em_channel_b_power')|float(0) +
          states('sensor.shelly_3em_channel_c_power')|float(0) }}
      unit_of_measurement: W
      device_class: power
      availability_template: >
        {{
          [ states('sensor.shelly_3em_channel_a_power'),
            states('sensor.shelly_3em_channel_b_power'),
            states('sensor.shelly_3em_channel_c_power') ] | map('is_number') | min }}

- sensor:
    - unique_id: energy_total
      default_entity_id: sensor.energy_total
      name: "Energy Total"
      icon: mdi:lightning-bolt-circle
      state: >
        {{ states('sensor.shelly_3em_channel_a_energy')|float(0) +
          states('sensor.shelly_3em_channel_b_energy')|float(0) +
          states('sensor.shelly_3em_channel_c_energy')|float(0) }}
      unit_of_measurement: kWh
      device_class: energy
      availability_template: >
        {{
          [ states('sensor.shelly_3em_channel_a_energy'),
            states('sensor.shelly_3em_channel_b_energy'),
            states('sensor.shelly_3em_channel_c_energy') ] | map('is_number') | min }}
